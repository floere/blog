<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-type" />
    <link href="../../../favico.ico" rel="shortcut icon" />
    <script src="../../../javascripts/shjs-0.6/sh_main.min.js" type="text/javascript"></script>
    <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
    <link href="../../../javascripts/shjs-0.6/css/sh_nedit.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../stylesheets/basic.css" rel="stylesheet" type="text/css" />
    <link href="../../../stylesheets/specific.css" rel="stylesheet" type="text/css" />
    <title>Picky&nbsp;Stemming</title>
    <script type="text/javascript">
      //<![CDATA[
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-20991642-1']);
        _gaq.push(['_trackPageview']);
        
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      //]]>
    </script>
  </head>
  <body onload='sh_highlightDocument("../../../javascripts/shjs-0.6/lang/", ".min.js");'>
    <ol class="nav">
      <li>
        <a href="./../../../../">home</a>
        •
      </li>
      <li>
        <a href="./../../../">blog</a>
        •
      </li>
      <li>
        <a href="./../../../../picky/">picky</a>
        •
      </li>
      <li>
        <a href="./../../../../phd/">phd</a>
        •
      </li>
      <li>
        <a href="./../../../../phony/">phony</a>
        •
      </li>
      <li>
        <a href="./../../../../view_models/">view models</a>
      </li>
    </ol>
    <div class="post">
      <h1>
        Picky&nbsp;Stemming
        <a class="twitter-share-button" data-count="none" data-text="Picky&amp;nbsp;Stemming" data-url="http://florianhanke.com/blog/2012/10/15/picky-stemming.html" data-via="hanke" data-width="55px" href="http://twitter.com/share">Tweet</a>
      </h1>
      <div class="categories">
        ruby / picky
      </div>
      <!-- /  - page.categories.each do |category| -->
      <!-- /    %a{ :href => "/blog/category/#{category}" }= category -->
      <p>This is a quick post about a new feature in Picky 4.6.6+: <a href="http://en.wikipedia.org/wiki/Stemming">stemming</a>.</p>
<h2>Stemming</h2>
<p>Stemming is used in information retrieval, and basically serves the purpose of &#8220;finding the thing&#8221; in an index, even if the appearance of the thing was different in the original.</p>
<p>In other words: if we had saved the word &#8220;arguing&#8221; in the index, then when somebody searches for &#8220;argued&#8221;, the saved document should still show up, even though &#8220;arguing&#8221; and &#8220;argued&#8221; are not exactly the same word. However, both are about the fact that somebody argued (a point, with somebody, themself or others). The words &#8220;argued&#8221; and &#8220;arguing&#8221; both resolve to the stem &#8220;argu&#8221;, which is not a word itself. This stem is what ends up in the index.</p>
<p>This was not yet possible in Picky.</p>
<p>And surprisingly, it did not seem urgent, as nobody complained.</p>
<p>Until, of course, <a href="http://goodfil.ms">somebody</a> did.</p>
<h2>Usage</h2>
<p>Let&#8217;s make this simple: how do you use this in Picky?</p>
<p>(Look up <a href="https://github.com/floere/picky/blob/c73bec8b01acb44dcb3a4a437fef1940fd03a08d/server/spec/functional/stemming_spec.rb">the current spec</a>, if that is most convenient to you.)</p>
<p>It is very easy. Both <code>Index#indexing</code> and <code>Search#searching</code> methods offer the option <code>stems_with</code>.</p>
<p>You give it an object that responds to <code>stem(word)</code>, which gets a tokenized word, and returns a stemmed word. One such stemmer is <code>Lingua::Stemmer</code>. In the tokenization pipeline, <a href="https://github.com/floere/picky/blob/c73bec8b01acb44dcb3a4a437fef1940fd03a08d/server/lib/picky/tokenizer.rb#L275">it is the last step</a> to be executed.</p>
<p>Therefore, if you want stemmed words in the index, use this:</p>
<pre class="sh_ruby"><code>index = Picky::Index.new :stemming do&#x000A;  indexing stems_with: Lingua::Stemmer.new&#x000A;  category :some_text_that_needs_to_be_stemmed&#x000A;end</code></pre>
<p>Usually, if you use stemming, you also want search terms to be stemmed when searching (otherwise your search for &#8220;arguing&#8221; will not find &#8220;argued&#8221; in the index).</p>
<pre class="sh_ruby"><code>index = Picky::Search.new index do&#x000A;  searching stems_with: Lingua::Stemmer.new&#x000A;end</code></pre>
<p>But as usual, the flexibility of Picky leaves that decision up to you: it could be that you are writing a stem-search, where you don&#8217;t stem in the search. Or you already only get stems for the index, no stemming needed (or even allowed), and you only need to stem on the user&#8217;s input.</p>
<h2>A word of caution</h2>
<p>If somebody searches for e.g. &#8220;Arguing!&#8221;, and you don&#8217;t remove the &#8220;!&#8221; (either by declaring it illegal in the tokenizer, or split on it), then Picky won&#8217;t stem it, since the stemmer doesn&#8217;t know what to do with &#8220;Arguing!&#8221;. It, however, would be perfectly able to stem &#8220;Arguing&#8221;. Consider yourself warned so we don&#8217;t have to argue later on.</p>
<p>Why anybody would search for &#8220;Arguing!&#8221;, I don&#8217;t know. I could for example see <a href="https://twitter.com/billmaher/status/256568696212967424">Paul Ryan</a> search for: &#8220;Arguing and debating, how does it work?&#8221;</p>
      Next
      <a href="/blog/2012/11/20/experimental-features-for-picky-5.html" title="Next post: Experimental&amp;nbsp;Features&amp;nbsp;for&amp;nbsp;Picky&amp;nbsp;5">Experimental&nbsp;Features&nbsp;for&nbsp;Picky&nbsp;5</a>
      <h2>Share</h2>
      <p>
        <a class="twitter-share-button" data-count="none" data-text="Picky&amp;nbsp;Stemming" data-url="http://florianhanke.com/blog/2012/10/15/picky-stemming.html" data-via="hanke" data-width="55px" href="http://twitter.com/share">Tweet</a>
      </p>
      <br />
      Previous
      <a class="previous" href="../../../2012/07/23/how-I-develop-a-feature.html" title="Previous post: How&amp;nbsp;I&amp;nbsp;develop&amp;nbsp;a&amp;nbsp;feature&amp;nbsp;for&amp;nbsp;Picky">How&nbsp;I&nbsp;develop&nbsp;a&nbsp;feature&nbsp;for&nbsp;Picky</a>
      <h2>Comments?</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        //<![CDATA[
          var disqus_shortname = 'florianhanke';
          var disqus_developer = location.host.match(/\.dev$|^localhost/) ? 1 : 0;
          var disqus_identifier = '/2012/10/15/picky-stemming';
          var disqus_url = 'http://florianhanke.com/blog/2012/10/15/picky-stemming.html';
          
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        //]]>
      </script>
      <noscript>
        Please enable JavaScript to view the
        <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
      </noscript>
    </div>
  </body>
</html>
